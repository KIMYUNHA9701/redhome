<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssangyong.redhome.dao.BoardMapper">


    <select id="selectQuestion" resultType="com.ssangyong.redhome.bean.Quest" parameterType="Integer">
        SELECT QUEST_NUM,QUEST_TITLE,QUEST_CONTENTS,QUEST_IMG,QUEST_PWD, TO_CHAR(QUEST_DATE,'YYYY"년" MM"월" dd"일" HH24:MI') As QUEST_DATE,
               QUEST_STATE,QUEST_CATEGORY_NUM, MEMBER_ID
        FROM quest
        WHERE quest_num = #{VALUE}
    </select>


    <select id="selectAnswer" resultType="com.ssangyong.redhome.bean.Answer" parameterType="Integer">
        SELECT * FROM answer
        WHERE quest_num = #{VALUE}

    </select>



    <select id="selectTotalCnt" resultType="Integer">

        select count(*)total from quest

    </select>



    <select id="getBoardPaging" resultType="com.ssangyong.redhome.bean.Quest" parameterType="java.util.HashMap" >


        select quest_num, quest_title, quest_contents, quest_img, quest_pwd, quest_date, quest_state, quest_category_num, member_id
        from (
        select /*+ INDEX_DESC(quest PK_QUEST) */ rownum rn, quest_num, quest_title, quest_contents,
        quest_img, quest_pwd, quest_date, quest_state, quest_category_num, member_id
        from quest

        <where>
            <choose>
                <when test='reply=="not_yet"'>
                    <![CDATA[       quest_num>0 and quest_state = '답변대기' and rownum > 0 and rownum <= (${pageNum} * ${amount})  )  ]]>
                </when>
                <otherwise>
                    <![CDATA[       quest_num>0 and rownum > 0 and rownum <= (${pageNum} * ${amount}) ) ]]>

                </otherwise>
            </choose>
        </where>

        <![CDATA[    where rn >(${pageNum} - 1) * ${amount}   ]]>

    </select>



</mapper>